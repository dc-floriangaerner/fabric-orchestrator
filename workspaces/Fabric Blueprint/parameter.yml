# Parameter Configuration for Fabric CI/CD
# This file defines find/replace patterns for transforming workspace item IDs
# across different environments (dev, test, prod)

find_replace:
    # Replace Connection String in Semantic Model (SQL endpoint)
    - find_value: 'database\s*=\s*Sql\.Database\s*\(\s*"([^"]+)"'
      replace_value:
          _ALL_: "$items.Lakehouse.lakehouse_silver.sqlendpoint"
      is_regex: "true"
      item_type: "SemanticModel"

    # Replace Database ID in Semantic Model with Database Name
    - find_value: 'database\s*=\s*Sql\.Database\s*\(\s*"[^"]+"\s*,\s*"([^"]+)"'
      replace_value:
          _ALL_: "lakehouse_silver"
      is_regex: "true"
      item_type: "SemanticModel"

    # Replace hardcoded workspace ID in CopyJob with dynamic workspace reference
    - find_value: "00000000-0000-0000-0000-000000000000"
      replace_value:
        _ALL_: "$workspace.id"
      item_type: "CopyJob"

    # Replace hardcoded lakehouse artifact ID in CopyJob
    - find_value: "b892bcb4-b1d3-a9e0-4a9e-fac33bb0b654"
      replace_value:
        _ALL_: "$items.Lakehouse.lakehouse_bronze.id"
      item_type: "CopyJob"

# INSTRUCTIONS: Add lakehouse and workspace ID transformations for your Dev workspace
# Once you have deployed to Dev and captured the actual IDs from your items,
# add find/replace rules here to enable promotion to Test and Prod environments.
#
# Example entries:
#     - find_value: "your-dev-lakehouse-bronze-id"
#       replace_value:
#         _ALL_: "$items.Lakehouse.lakehouse_bronze.id"
#       item_type: "Notebook"
#     - find_value: "your-dev-lakehouse-silver-id"
#       replace_value:
#         _ALL_: "$items.Lakehouse.lakehouse_silver.id"
#       item_type: "Notebook"
#     - find_value: "your-dev-lakehouse-gold-id"
#       replace_value:
#         _ALL_: "$items.Lakehouse.lakehouse_gold.id"
#       item_type: "Notebook"
#     - find_value: "your-dev-workspace-id"
#       replace_value:
#         _ALL_: "$workspace.id"
#       item_type: "Notebook"
